<canvas id="casesByDateChat"></canvas>
<div>
  <span class="mdc-typography--caption"><strong>Ano:</strong> <%= Time.zone.now.year %></span><br/>
  <span class="mdc-typography--caption"><strong>Fonte:</strong> <a href="https://covid19-brazil-api.now.sh/" target="_blank">Covid19 Brazil API</a></span>
<div>
<% content_for :javascript do %>
  <script>
    var DATES = <%= raw @cases_by_date.map { |c| c.date.strftime('%d/%m') } %>
    var CASES = <%= raw @cases_by_date.map { |c| c.cases } %>
    var DEATHS = <%= raw @cases_by_date.map { |c| c.deaths } %>
  </script>
  <%= javascript_pack_tag 'chart', 'data-turbolinks-track': 'reload' %>
<% end %>

<hr/>

<div id="location-map"></div>

<script type="text/javascript">
  var map = L.map('location-map').setView([<%= @brazil.coordinates[0] %>, <%= @brazil.coordinates[1] %>], 5);

  mapLink = '<a href="https://openstreetmap.org">OpenStreetMap</a>';

  L.tileLayer(
    'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data &copy; ' + mapLink,
    maxZoom: 20,
  }).addTo(map);

  <% @cities.each do |city| %>
    L.marker(L.latLng(<%= city.coordinates %>)).addTo(map);
  <% end %>
</script>